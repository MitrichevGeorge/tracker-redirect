# tracker-redirect

Короче, в чём пока моя идея
## 1. что хочу из owner experience
беру типа ссылку, как в сокращатель, кидаю юзеру, вижу запросы
сервак юзеру даёт либо страницу которая мне всё о нем передаст и редиректнет его
или прям в заголовке ответа даст 307 (не 301, потому что тот кэшируется браузером)

<details>
<summary>(из мечтаний) сценарии использования</summary>

1. Рекламлю значит например свой какойниюудь тг бот, создаю 10 разных ссылок на своего бота, клею qr и помучаю какой где висит и потом вижу с какого qr кто когда и скаким устройством зашёл и может какие-то выводы из этого делаю
2. пишу значит какуб-то фигню в github markdown и вставляю картинку и вижу когда читают (подробнее - гуглить "zero pixel image analitics")
3. кидаю кенту ссылку, хочу понять открыл ли он её
4. просто повыёбываться
5. сокарщать нереально длинные ссылки

</details>

## 2. чё будет в бд
ну наверно надо будет 2 таблицы
1. адреса куда ведут ссылки и инфа о ссылке
  столбики
  - входной ендпоинт(путь на нашем серваке) - строка и наверно ключ
  - url куда перекинуть
  - как перекинуть (ну страница или прям в заголовках)
  - уведомлять ли
  - и тп 

3. переходы по нашим ссылкам
  - ендпоинт куда пришёл запрос
  - инфа о юзере(ip, useragent, мб геолокация итп)
  - datetime запроса
  про ключ хз, наверно надо будет ввести что-то типа id запроса

#### чё хочу от бд
1. быстро добавлять новый запрос в список и чтоб этот список мог быть длинной хоть в 10к хоть в 2 млн строк
2. быстро находить адрес по названию ендпоинта
3. брать запросы отсортировав их по ендроинтам / устройствам / датам
4. наверно надо синхронный writer, очередь и асинхронные методы доступа

## Из чего состоит сервер
1. ответчик на запросы - редирект и добавление в бд и стабильность относительно ddos
2. бд
3. api для админки, мб потом ещё для добавления инфы, а так наверно лучше на другой порт + доступ только из wg

## чё хотим оот slug - приёмника:
1. тупой и быстрый
2. выбор режима - 307 / html <meta> / html js
3. если html то <= 8kb
4. отброс совсем тупых curl - наверно сделать параметр `strict_browser`
5. ratelimit по ip и вообще
